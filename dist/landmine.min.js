//landmine.js
!function(){"use strict";var a={},b=function(){var a,b,c={},d=0,e=arguments.length;for(d=0;e>d;d++){b=arguments[d];for(a in b)void 0!==b[a]&&(c[a]=b[a])}return c},c=function(b,c){a[b]||(a[b]=c)},d=function(b,c){!a[b]&&module&&module.exports&&(a[b]=c)};d("extend",b);var e=function(a){"undefined"==typeof a&&(a={});var c={width:80,height:40};this.options=b(c,a),Object.defineProperty(this,"width",{enumerable:!0,value:this.options.width}),Object.defineProperty(this,"height",{enumerable:!0,value:this.options.height}),this.field=Array(this.width);for(var d=0;d<this.width;d++){this.field[d]=Array(this.height);for(var e=0;e<this.height;e++)this.field[d][e]=new g}};e.prototype.get=function(a,b){if(!this.isInRange(a,b))throw"position out of range";return this.field[a][b]};var f=[{x:-1,y:-1},{x:-1,y:0},{x:-1,y:1},{x:0,y:-1},{x:0,y:1},{x:1,y:-1},{x:1,y:0},{x:1,y:1}];e.prototype.getNeighbors=function(a,b){for(var c=[],d=0,e=f.length;e>d;d++){var g=f[d],h=a+g.x,i=b+g.y;this.isInRange(h,i)&&c.push(this.get(h,i))}return c},e.prototype.isInRange=function(a,b){return a>=0&&a<this.width&&b>=0&&b<this.height},e.prototype.countMines=function(a,b){for(var c=this.getNeighbors(a,b),d=0,e=c.length-1;e>=0;e--)c[e].hasMine&&d++;return d},e.prototype.forEach=function(a){var b=0,c=0,d=this.width;for(this.l,b=0;d>b;b++)for(c=0;h>c;c++)a(this.get(b,c),b,c)},e.prototype.countAllMines=function(){var a=this;this.forEach(function(b,c,d){b.count=a.countMines(c,d)})},c("MineField",e);var g=function(){this.hasMine=!1,this.count=0,this.dug=!1};g.prototype.dig=function(){if(this.hasMine)throw"exploded";this.dug=!0},g.prototype.placeMine=function(){this.hasMine=!0};var i=function(){};i.prototype.placeMines=function(a,b){if(b>this.totalPlacableMines(a))throw"Can't place "+b+" mines in a field sized "+a.width+"x"+a.height;for(var c=0;b>c;c++)this.placeMine(a)},i.prototype.placeMine=function(a){var b,c,d=!1;do c=this.randomLocation(a),b=a.get(c.x,c.y),b.hasMine||(b.placeMine(),d=!0);while(!d)},i.prototype.randomLocation=function(a){return{x:Math.floor(Math.random()*(a.width-1))+1,y:Math.floor(Math.random()*a.height)}},i.prototype.totalPlacableMines=function(a){return(a.width-1)*a.height},d("MinePlacer",i),"undefined"==typeof window||window.Landmine?module&&module.exports&&(module.exports=a):window.Landmine=a}();